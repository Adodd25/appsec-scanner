# Application Security Scanner Configuration
# Copy this file to .appsec-config.yml in your project root

# =============================================================================
# SCAN OPTIONS
# =============================================================================
scan:
  # Enable/disable specific scanners
  python: true        # Run Bandit Python scanner
  javascript: true    # Run ESLint security scan (includes TypeScript)
  secrets: true       # Run secret detection
  dependencies: true  # Run npm audit and pip-audit for dependencies
  semgrep: true       # Run Semgrep SAST (data flow analysis, taint tracking)

  # Directories to exclude from scanning
  # These are applied to file discovery, not passed to individual tools
  exclude:
    - "**/node_modules/**"
    - "**/__pycache__/**"
    - "**/venv/**"
    - "**/env/**"
    - "**/.venv/**"
    - "**/.git/**"
    - "**/dist/**"
    - "**/build/**"

# =============================================================================
# SEVERITY THRESHOLDS
# =============================================================================
severity:
  # Exit with error code if issues at this level or above are found
  # Options: critical, high, medium, low
  fail_on: "high"

# =============================================================================
# OUTPUT OPTIONS
# =============================================================================
output:
  # Output formats to generate
  # Available: text, json, html, sarif
  formats:
    - "text"
    - "json"
    - "html"
    - "sarif"

  # Output file paths
  json_file: "security-results.json"
  html_file: "security-report.html"
  sarif_file: "security-results.sarif"

  # Enable verbose output for debugging
  verbose: false

# =============================================================================
# RISK SCORING
# =============================================================================
risk_scoring:
  # Weight for each severity level (used to calculate risk score 0-100)
  weights:
    critical: 25
    high: 10
    medium: 3
    low: 1

  # Risk thresholds for categorization
  thresholds:
    critical: 75  # Score >= 75 is critical risk
    high: 50      # Score >= 50 is high risk
    medium: 25    # Score >= 25 is medium risk
